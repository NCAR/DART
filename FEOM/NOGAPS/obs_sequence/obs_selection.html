<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
          "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<TITLE>PROGRAM obs_selection</TITLE>
<link rel="stylesheet" type="text/css" href="../doc/html/doc.css" />
<link href="../doc/html/dart.ico" rel="shortcut icon" />
</HEAD>
<BODY>
<A NAME="TOP"></A>

<H1>PROGRAM <em class=program>obs_selection</em></H1>

<table border=0 summary="" cellpadding=5>
<tr>
    <td valign=middle>
    <img src="../doc/html/Dartboard7.png" alt="DART project logo" height=70 />
    </td>
    <td>
       <P>Jump to <a href="../index.html">DART Documentation Main Index</a><br />
          <small><small>version information for this file: <br />
          <!-- version tag follows, do not edit -->
          $Id$</small></small>
       </P></td>
</tr>
</table>

<A HREF="#Namelist">NAMELIST</A> /
<A HREF="#Building">BUILDING</A> /
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#Legalese">TERMS OF USE</A>

<H2>Overview</H2>

<P>
This specialized tool selects out a subset of the input observations.
For a more general purpose tool, see the
<a href="obs_sequence_tool.html">obs_sequence_tool</a>.
The tool which creates the input selection file is
<a href="obs_seq_coverage.html">obs_seq_coverage</a>.
This tool takes a selected list of observation
types, times, and locations, and extracts only the matching
observations out of a longer set of obs_sequence files.
</P>
<P>
The actions of the <em class=code>obs_selection</em> program
are controlled by a Fortran namelist, read from a file named
<em class=file>input.nml</em> in the current directory.  A detailed
description of each namelist item is described in the
<a href="#Namelist">namelist section</a> of this document.
The names used in this discussion refer to these namelist items.
</P>

<!--==================================================================-->
<!--=================== DESCRIPTION OF A NAMELIST ====================-->
<!--==================================================================-->

<A NAME="Namelist"></A>
<HR>
<H2>NAMELIST</H2>
<P>We adhere to the F90 standard of starting a namelist with an ampersand
'&amp;' and terminating with a slash '/' for all our namelist input.
</P>
<div class=namelist>
<pre>
<em class=call>namelist / obs_selection_nml / </em>
        filename_seq, filename_seq_list, num_input_files, filename_out,
        selection_file, print_only, calendar
</pre>
</div>

<div class=indent1><!-- Description -->

<P>
This <em class=code>&amp;obs_selection</em> namelist is read from
the <em class=file>input.nml</em> file.
</P>

<TABLE border=0 cellpadding=3 width=100%>
<TR><TH align=left>Contents    </TH>
    <TH align=left>Type        </TH>
    <TH align=left>Description </TH></TR>
<TR><!--contents--><TD valign=top>filename_seq</TD>
    <!--  type  --><TD>character(len=129), dimension(500)</TD>
    <!--descript--><TD>The array of names of the observation sequence files to process,
                       up to a max count of 500 files. (Specify only the actual number of
                       input files.  It is not necessary to specify 500 entries.)
                       Default: ''</TD></TR>
<TR><!--contents--><TD valign=top>filename_seq_list</TD>
    <!--  type  --><TD>character(len=129)</TD>
    <!--descript--><TD>An alternative way to specify the list of input files.
                       The name of a text file which contains, one per line,
                       the names of the observation sequence files to process.
                       You can only specify one of filename_seq OR
                       filename_seq_list, not both.
                       Default: ''</TD></TR>
<TR><!--contents--><TD valign=top>num_input_files</TD>
    <!--  type  --><TD>integer</TD>
    <!--descript--><TD>Optional.  The number of observation sequence files to process.
                       Maximum of 500.  If left 0, the length is set by the
                       number of input files given.  If non-zero, must match
                       the given input file list length.
                       Default: 0</TD></TR>
<TR><!--contents--><TD valign=top>filename_out</TD>
    <!--  type  --><TD>character(len=129)</TD>
    <!--descript--><TD>The name of the resulting output observation sequence file.
                       Default: 'obs_seq.processed'</TD></TR>
<TR><!--contents--><TD valign=top>selections_file</TD>
    <!--  type  --><TD>character(len=129)</TD>
    <!--descript--><TD>The name of the input file containing the mask of observation
                       definitions (the textfile output of <a href="obs_seq_coverage.html">obs_seq_coverage</a>).
                       Default: 'obsdef_mask.txt'</TD></TR>
<TR><!--contents--><TD valign=top>print_only</TD>
    <!--  type  --><TD>logical</TD>
    <!--descript--><TD>If .TRUE. do not create an output file, but print a summary of the
                       number and types of each observation in each input file, and then
                       the number of observations and types which would have been created in
                       an output file.
                       Default: .false.</TD></TR>
<TR><!--contents--><TD valign=top>calendar</TD>
    <!--  type  --><TD>character(len=32)</TD>
    <!--descript--><TD>Set to the name of the calendar; only controls the
         printed output for the dates of the first and last observations in
         the file.  Set this to "no_calendar" if the
         observations are not using any calendar.
                       Default "gregorian".</TD></TR>
</TABLE>

</div>
<br>

<!--==================================================================-->

<A NAME="Building"></A>
<HR>
<H2>BUILDING</H2>

<P>
Most <tt>$DART/models/*/work</tt> directories will build the tool along with
other executable programs.  It is also possible to build the
tool in the <tt>$DART/observations/utilities</tt> directory.
The <tt>preprocess</tt> program must be built and run first, to define
what set of observation types will be supported.  See the
<a href="../preprocess/preprocess.html">preprocess documentation</a>
for more details on how to define the list and run it.
The combined list of all observation types which will be encountered
over all input files must be in the preprocess input list.
The other important choice when building the tool is to include a
compatible locations module.  For the low-order models,
the <tt>oned</tt> module should be used; for real-world observations,
the <tt>threed_sphere</tt> module should be used.
</P>
<P>Generally the directories where executables are built will include
a "quickbuild.csh" script which will build and run preprocess and then
build the rest of the executables.  The "input.nml" namelists will need
to be edited to include all the required observation types first.
</P>


<!--==================================================================-->

<A NAME="OtherModulesUsed"></A>
<HR>
<H2>MODULES USED</H2>
<PRE>
types_mod
utilities_mod
time_manager_mod
obs_def_mod
obs_sequence_mod
</PRE>

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<HR>
<H2>FILES</H2>
<UL><LI><em class=file>input.nml</em></LI>
    <LI>The input files specified in the <em class=code>filename_seq</em>
        namelist variable.</LI>
    <LI>The output file specified in the <em class=code>filename_out</em>
        namelist variable.</LI>
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<HR>
<H2>REFERENCES</H2>
<ul>
<li> none </li>
</ul>

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR>
<H2>ERROR CODES and CONDITIONS</H2>
<div class=errors>
<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>

<TR><!-- routine --><TD VALIGN=top>obs_selection</TD>
    <!-- message --><TD VALIGN=top>num_input_files &gt; max_num_input_files.
		    change max_num_input_files in source file</TD>
    <!-- comment --><TD VALIGN=top>The default is 500 files.</TD>
</TR>

<TR><!-- routine --><TD VALIGN=top>obs_selection</TD>
    <!-- message --><TD VALIGN=top>num_input_files and filename_seq mismatch</TD>
    <!-- comment --><TD VALIGN=top>The number of filenames does not match
                        the filename count.</TD>
</TR>
</TABLE>
</div>

<H2>KNOWN BUGS</H2>
<P>
none
</P>

<!--==================================================================-->
<!-- Describe Future Plans.                                           -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<HR>
<H2>FUTURE PLANS</H2>
<P>
Long laundry list of things this tool could do, including:
</P>
<UL>
<LI>Remove duplicates (difficult to accurately compare floating
    point values, but identical obs should be possible to recognize,
    or some epsilon could be specified.)</LI>
</UL>

<!--==================================================================-->
<!-- Legalese & Metadata                                              -->
<!--==================================================================-->

<A NAME="Legalese"></A>
<HR>
<H2>Terms of Use</H2>

<P>
DART software - Copyright 2004 - 2013 UCAR.<br>
This open source software is provided by UCAR, "as is",<br>
without charge, subject to all terms of use at<br>
<a href="http://www.image.ucar.edu/DAReS/DART/DART_download">
http://www.image.ucar.edu/DAReS/DART/DART_download</a>
</P>

<TABLE border=0 cellpadding=0 width=100% summary="">
<TR><TD valign=top>Contact:       </TD><TD> DART core group   </TD></TR>
<TR><TD valign=top>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD valign=top>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD valign=top>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD valign=top>Change&nbsp;history:&nbsp;</TD><TD> try "svn&nbsp;log" or "svn&nbsp;diff" </TD></TR>
</TABLE>

<!--==================================================================-->

</BODY>
</HTML>
